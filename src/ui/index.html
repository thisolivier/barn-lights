<!doctype html>
<meta charset="utf-8" />
<title>BarnLights Playbox</title>
<style>
  :root { --gap: 20px; }
  body { font: 14px system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 20px; color:#111; }
  h1 { margin: 0 0 8px; font-size: 20px; }
  .row { display:flex; gap: var(--gap); align-items:center; margin: 6px 0; flex-wrap: wrap; }
  label { display:flex; align-items:center; gap:8px; min-width: 220px; }
  input[type="range"] { width: 180px; }
  select { padding: 4px 6px; }
  fieldset { border:1px solid #ccc; padding:10px 14px; margin-bottom:var(--gap); }
  legend { padding:0 6px; font-weight:bold; }
  .desc { font-size:12px; color:#555; }
  .barn { display:flex; gap: 32px; perspective: 900px; margin-top: 16px; }
  canvas { width: 512px; height: 128px; image-rendering: pixelated; border-radius: 10px; box-shadow: 0 10px 30px rgba(0,0,0,.25); background:#000; }
  #left { transform: rotateY(15deg) skewY(-2deg); }
  #right{ transform: rotateY(-15deg) skewY(2deg);  }
  .panel { display:flex; flex-direction:column; gap:var(--gap); align-items:flex-start; }
  .kbd { padding:1px 6px; border:1px solid #ccc; border-radius:4px; background:#f7f7f7; font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }
</style>

<link rel="stylesheet" href="/vendor/grapick/dist/grapick.min.css">
<script src="/vendor/grapick/dist/grapick.min.js"></script>

  <h1>BarnLights Playbox</h1>
  <div id="status"></div>
<div class="panel">
  <fieldset>
    <legend>Effect</legend>
    <div class="row">
      <label>Effect
        <select id="effect">
          <option>gradient</option>
          <option>solid</option>
          <option>fire</option>
          <option>fireShader</option>
        </select>
      </label>
    </div>
    <div class="row" id="effectControls"></div>
  </fieldset>

  <fieldset>
    <legend>General</legend>
    <div class="row">
      <label>Brightness <input id="brightness" type="range" min="0" max="1" step="0.01"><span id="brightness_v"></span></label>
      <label>Gamma <input id="gamma" type="range" min="0.5" max="3" step="0.01"><span id="gamma_v"></span><small class="desc">brightness curve</small></label>
      <label>Roll px <input id="rollPx" type="range" min="0" max="512" step="1"><span id="rollPx_v"></span><small class="desc">shift pattern</small></label>
      <label>FPS cap <input id="fpsCap" type="range" min="1" max="60" step="1"><span id="fpsCap_v"></span></label>
      <label>Wall mode
        <select id="wallMode">
          <option value="duplicate">Duplicate</option>
          <option value="independent">Independent</option>
          <option value="extend">Extend</option>
        </select>
      </label>
    </div>
  </fieldset>

  <fieldset>
    <legend>Strobe</legend>
    <div class="row">
      <label>Strobe Hz <input id="strobeHz" type="range" min="0" max="20" step="0.1"><span id="strobeHz_v"></span></label>
      <label>Duty <input id="strobeDuty" type="range" min="0" max="1" step="0.01"><span id="strobeDuty_v"></span><small class="desc">on-time %</small></label>
      <label>Low <input id="strobeLow" type="range" min="0" max="1" step="0.01"><span id="strobeLow_v"></span><small class="desc">min brightness</small></label>
    </div>
  </fieldset>

  <fieldset>
    <legend>Tint</legend>
    <div class="row">
      <label>Tint R <input id="tintR" type="range" min="0" max="1" step="0.01"><span id="tintR_v"></span></label>
      <label>Tint G <input id="tintG" type="range" min="0" max="1" step="0.01"><span id="tintG_v"></span></label>
      <label>Tint B <input id="tintB" type="range" min="0" max="1" step="0.01"><span id="tintB_v"></span></label>
    </div>
  </fieldset>

  <div>Hotkeys: <span class="kbd">1/2/3/4</span> effects, <span class="kbd">B</span> blackout (brightness=0), <span class="kbd">Space</span> freeze UI preview.</div>
</div>

<div class="barn">
  <canvas id="left"  width="512" height="128"></canvas>
  <canvas id="right" width="512" height="128"></canvas>
</div>

<script type="module">
  import { boot } from './preview.mjs';
  boot();
</script>
